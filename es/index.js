var u=Object.assign;var d=(c,i,e)=>new Promise((l,s)=>{var t=a=>{try{y(e.next(a))}catch(o){s(o)}},r=a=>{try{y(e.throw(a))}catch(o){s(o)}},y=a=>a.done?l(a.value):Promise.resolve(a.value).then(t,r);y((e=e.apply(c,i)).next())});import b from"querystring-number";var h={},m=(l,s,...t)=>d(void 0,[l,s,...t],function*(c,i,e={}){let r;r=i&&JSON.stringify(i);let y=(e.baseUrl||"")+c,a=y+r;if(e.cacheTime){let n=h[a];if(n&&Date.now()-n.time<e.cacheTime)return n}let o=Object.prototype.toString.call(i)==="[object FormData]";return e.headers||(e.headers={}),e.headers["Content-Type"]||(o?e.headers["Content-Type"]="application/x-www-form-urlencoded":e.headers["Content-Type"]="application/json"),e.method==="GET"&&!e.headers["Cache-Control"]&&(e.headers["Cache-Control"]="public, max-age=604800, immutable"),fetch(y,u(u({body:r},e),{headers:e.headers})).then(n=>d(void 0,null,function*(){return{body:yield n[e.format||"json"](),status:n.status,headers:n.headers}})).then(n=>d(void 0,null,function*(){return e.cacheTime&&(h[a]={data:n,time:Date.now()}),e.reduce&&(n=yield Promise.resolve(e.reduce(n))),e.onSuccess&&(yield Promise.resolve(e.onSuccess(n))),n})).catch(n=>d(void 0,null,function*(){e.onError&&(yield Promise.resolve(e.onError(n)))}))}),T=(c,i,e,l,s,t)=>d(void 0,null,function*(){if(typeof window=="undefined")return;let r="/"+i;return e&&(r+="?"+b.stringify(e)),m(r,l,u(u(u({},s),t),{method:c}))}),w={get:!0,post:!0,put:!0,del:!0,options:!0},_=(c={})=>{let i=e=>new Proxy(e,{get(s,t){if(!s[t])if(!w[t])s[t]=i({___parent:s.___parent?s.___parent+"/"+t:t});else{let r=t.toUpperCase();r==="DEL"&&(r="DELETE");let y=s.___parent;s[t]=(a={})=>{let{query:o,body:n,options:f}=a;return!o&&!n&&!f&&(r==="GET"?o=a:n=a),T(r,y,o,n,c,f)}}return s[t]}});return i(c.baseData||{})};export{m as baseApi,_ as createZeroApi};
