var u=Object.assign;var d=(y,t,e)=>new Promise((f,n)=>{var a=s=>{try{o(e.next(s))}catch(c){n(c)}},i=s=>{try{o(e.throw(s))}catch(c){n(c)}},o=s=>s.done?f(s.value):Promise.resolve(s.value).then(a,i);o((e=e.apply(y,t)).next())});import h from"querystring-number";var m={},T=(f,n,...a)=>d(void 0,[f,n,...a],function*(y,t,e={}){let i,o="";e.method==="GET"?o="?"+h.stringify(t):i=t&&JSON.stringify(t);let s=(e.baseUrl||"")+y+o,c=s+i;if(e.cacheTime){let r=m[c];if(r&&Date.now()-r.time<e.cacheTime)return r}let l=Object.prototype.toString.call(t)==="[object FormData]";return e.headers||(e.headers={}),e.headers["Content-Type"]||(l?e.headers["Content-Type"]="application/x-www-form-urlencoded":e.headers["Content-Type"]="application/json"),e.method==="GET"&&!e.headers["Cache-Control"]&&(e.headers["Cache-Control"]="public, max-age=604800, immutable"),fetch(s,u(u({body:i},e),{headers:e.headers})).then(r=>d(void 0,null,function*(){return{body:yield r[e.format||"json"](),status:r.status,headers:r.headers}})).then(r=>d(void 0,null,function*(){return e.cacheTime&&(m[c]={data:r,time:Date.now()}),e.reduce&&(r=yield Promise.resolve(e.reduce(r))),e.onSuccess&&(yield Promise.resolve(e.onSuccess(r))),r})).catch(r=>d(void 0,null,function*(){e.onError&&(yield Promise.resolve(e.onError(r)))}))}),w=(y,t,e,f,n,a)=>d(void 0,null,function*(){if(typeof window=="undefined")return;let i="/"+t;return e&&(i+="?"+h.stringify(e)),T(i,f,u(u(u({},n),a),{method:y}))}),_={get:!0,post:!0,put:!0,del:!0,options:!0},b=(y={})=>{let t=e=>new Proxy(e,{get(n,a){if(!n[a])if(!_[a])n[a]=t({___parent:n.___parent?n.___parent+"/"+a:a});else{let i=a.toUpperCase(),o=n.___parent;n[a]=({query:s,body:c,options:l}={})=>w(i,o,s,c,y,l)}return n[a]}});return t({})};export{T as baseApi,b as createZeroApi};
